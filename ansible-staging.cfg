[defaults]
# Staging Configuration for VPN Infrastructure Testing
# Use with: ansible-playbook -i inventories/staging --config-file ansible-staging.cfg

inventory = inventories/staging
host_key_checking = False
retry_files_enabled = False
stdout_callback = yaml
bin_ansible_callbacks = True
callback_whitelist = timer, profile_tasks, profile_roles

# Staging Performance Settings - Conservative for testing
forks = 10
serial = 5
gathering = smart
fact_caching = jsonfile
fact_caching_timeout = 3600
fact_caching_connection = /tmp/ansible_facts_cache_staging
gather_subset = !hardware,!facter,!ohai
inject_facts_as_vars = False
hash_behaviour = merge

# Staging SSH Configuration
timeout = 60
connect_timeout = 30
remote_user = ansible
private_key_file = ~/.ssh/ansible_ed25519
ansible_ssh_pipelining = True
host_key_auto_add = True
transport = smart

# Staging Logging - More verbose for debugging
log_path = logs/ansible-staging.log
display_skipped_hosts = True
display_ok_hosts = True
display_args_to_stdout = True
force_color = True

# Staging Vault Configuration
vault_password_file = .vault_password_staging
vault_identity_list = staging@.vault_password_staging

# Staging Paths
roles_path = roles:collections:~/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles
collections_path = collections:~/.ansible/collections:/usr/share/ansible/collections

# Staging Error Handling - More permissive for testing
any_errors_fatal = False
max_fail_percentage = 20

[ssh_connection]
ssh_args = -C -o ControlMaster=auto -o ControlPersist=300s -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -o ServerAliveInterval=60 -o ServerAliveCountMax=3
pipelining = True
control_path_dir = /tmp/.ansible-cp-staging
control_path = %(directory)s/ansible-staging-%%h-%%p-%%r
retries = 3

[persistent_connection]
connect_timeout = 60
command_timeout = 120

[privilege_escalation]
become = True
become_method = sudo
become_user = root
become_ask_pass = False
become_flags = -H -S -n

[inventory]
enable_plugins = host_list, script, auto, yaml, ini, toml

[galaxy]
server_list = galaxy

[galaxy_server.galaxy]
url = https://galaxy.ansible.com/

[module_defaults]
# Staging defaults - Enable backups and validation
copy:
  backup: yes
template:
  backup: yes
lineinfile:
  backup: yes
blockinfile:
  backup: yes