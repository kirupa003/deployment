# Fail2Ban filter for WireGuard
# Generated by Ansible - DO NOT EDIT MANUALLY

[Definition]

# Option: failregex
# Notes.: regex to match the password failures messages in the logfile. The
#         host must be matched by a group named "host". The tag "<HOST>" can
#         be used for standard IP/hostname matching and is only an alias for
#         (?:::f{4,6}:)?(?P<host>[\w\-.^_]+)
# Values: TEXT
#
failregex = ^.*WireGuard.*: Invalid handshake initiation from <HOST>.*$
            ^.*WireGuard.*: Handshake did not complete after \d+ seconds, retrying \(try \d+\) from <HOST>.*$
            ^.*WireGuard.*: Packet has unallowed src IP <HOST>.*$
            ^.*WireGuard.*: Invalid MAC of handshake, dropping packet from <HOST>.*$
            ^.*WireGuard.*: Packet is not from allowed peer <HOST>.*$
            ^.*kernel:.*wireguard.*: Invalid handshake initiation from <HOST>.*$
            ^.*kernel:.*wireguard.*: Packet has unallowed src IP <HOST>.*$

# Option: ignoreregex
# Notes.: regex to ignore. If this regex matches, the line is ignored.
# Values: TEXT
#
ignoreregex =

[Init]

# Option: journalmatch
# Notes.: systemd journal match for WireGuard logs
journalmatch = _SYSTEMD_UNIT=wg-quick@wg0.service + _SYSTEMD_UNIT=wireguard.service