# Fail2Ban action for CrowdSec integration
# Generated by Ansible - DO NOT EDIT MANUALLY

[Definition]

# Option: actionstart
# Notes.: command executed once at the start of Fail2Ban.
# Values: CMD
#
actionstart = 

# Option: actionstop
# Notes.: command executed once at the end of Fail2Ban
# Values: CMD
#
actionstop = 

# Option: actioncheck
# Notes.: command executed once before each actionban command
# Values: CMD
#
actioncheck = 

# Option: actionban
# Notes.: command executed when banning an IP. Take care that the
#         command is executed with Fail2Ban user rights.
# Tags:   See jail.conf(5) man page
# Values: CMD
#
actionban = /usr/bin/curl -X POST http://localhost:8080/v1/decisions \
            -H "Content-Type: application/json" \
            -H "X-Api-Key: {{ crowdsec_api_key | default('') }}" \
            -d '{"duration": "{{ bantime }}s", "scope": "Ip", "value": "<ip>", "type": "ban", "scenario": "fail2ban/<name>"}'

# Option: actionunban
# Notes.: command executed when unbanning an IP. Take care that the
#         command is executed with Fail2Ban user rights.
# Tags:   See jail.conf(5) man page
# Values: CMD
#
actionunban = /usr/bin/curl -X DELETE "http://localhost:8080/v1/decisions?scope=Ip&value=<ip>" \
              -H "X-Api-Key: {{ crowdsec_api_key | default('') }}"

[Init]

# Default name of the chain
#
name = default

# Option: protocol
# Notes.: internally used by config reader for interpolations.
# Values: [ tcp | udp | icmp | all ] Default: tcp
#
protocol = tcp

# Option: chain
# Notes.: specifies the iptables chain to which the Fail2Ban rules should be
#         added
# Values: STRING  Default: INPUT
#
chain = INPUT