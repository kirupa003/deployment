# Fail2Ban filter for OpenVPN (Enhanced)
# Generated by Ansible - DO NOT EDIT MANUALLY

[Definition]

# Option: failregex
# Notes.: regex to match the password failures messages in the logfile. The
#         host must be matched by a group named "host". The tag "<HOST>" can
#         be used for standard IP/hostname matching and is only an alias for
#         (?:::f{4,6}:)?(?P<host>[\w\-.^_]+)
# Values: TEXT
#
failregex = ^.*openvpn.*: TLS Error: TLS key negotiation failed to occur within 60 seconds \(check your network connectivity\) from <HOST>:\d+.*$
            ^.*openvpn.*: TLS Error: TLS handshake failed from <HOST>:\d+.*$
            ^.*openvpn.*: \[.*\] Peer Connection Initiated with <HOST>:\d+ \[AF_INET\].*FAILED.*$
            ^.*openvpn.*: TLS_ERROR: BIO read tls_read_plaintext error: error:.*:SSL routines:.*:sslv3 alert bad certificate from <HOST>:\d+.*$
            ^.*openvpn.*: TLS Error: cannot locate HMAC in incoming packet from <HOST>:\d+.*$
            ^.*openvpn.*: Fatal TLS error \(check_tls_errors_co\), restarting from <HOST>:\d+.*$
            ^.*openvpn.*: VERIFY ERROR: depth=\d+, error=certificate verify failed: .* from <HOST>:\d+.*$
            ^.*openvpn.*: TLS Error: Unroutable control packet received from <HOST>:\d+.*$
            ^.*openvpn.*: WARNING: Bad encapsulated packet length from peer \(<HOST>:\d+\).*$
            ^.*openvpn.*: Bad LZO decompression header byte: .* from <HOST>:\d+.*$
            ^.*openvpn.*: Authenticate/Decrypt packet error: packet HMAC authentication failed from <HOST>:\d+.*$
            ^.*openvpn.*: MULTI: bad source address from client \[<HOST>\].*$
            ^.*openvpn.*: \[.*\] Inactivity timeout \(--ping-restart\), restarting from <HOST>:\d+.*$

# Option: ignoreregex
# Notes.: regex to ignore. If this regex matches, the line is ignored.
# Values: TEXT
#
ignoreregex = ^.*openvpn.*: \[.*\] Peer Connection Initiated with <HOST>:\d+ \[AF_INET\]$
              ^.*openvpn.*: <HOST>:\d+ \[.*\] Peer Connection Initiated with.*$

[Init]

# Option: journalmatch
# Notes.: systemd journal match for OpenVPN logs
journalmatch = _SYSTEMD_UNIT=openvpn.service + _SYSTEMD_UNIT=openvpn@.service