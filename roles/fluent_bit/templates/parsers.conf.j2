# Fluent Bit Parsers Configuration
# Generated by Ansible - Do not edit manually

{% for parser in fluent_bit_parsers %}
[PARSER]
    Name        {{ parser.name }}
    Format      {{ parser.format }}
{% if parser.regex is defined %}
    Regex       {{ parser.regex }}
{% endif %}
{% if parser.time_key is defined %}
    Time_Key    {{ parser.time_key }}
{% endif %}
{% if parser.time_format is defined %}
    Time_Format {{ parser.time_format }}
{% endif %}
{% if parser.time_keep is defined %}
    Time_Keep   {{ parser.time_keep }}
{% endif %}

{% endfor %}

# Additional DNS-specific parsers
[PARSER]
    Name        dnsmasq
    Format      regex
    Regex       ^(?<timestamp>\w+\s+\d+\s+\d+:\d+:\d+)\s+dnsmasq\[(?<pid>\d+)\]:\s+(?<query_type>\w+)\s+(?<query_name>\S+)\s+from\s+(?<client_ip>\d+\.\d+\.\d+\.\d+)
    Time_Key    timestamp
    Time_Format %b %d %H:%M:%S

[PARSER]
    Name        unbound
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2})\s+unbound:\s+\[(?<pid>\d+):(?<thread>\d+)\]\s+info:\s+(?<client_ip>\d+\.\d+\.\d+\.\d+)\s+(?<query_name>\S+)\.\s+(?<query_type>\w+)\s+(?<query_class>\w+)
    Time_Key    timestamp
    Time_Format %Y-%m-%d %H:%M:%S

[PARSER]
    Name        bind9
    Format      regex
    Regex       ^(?<timestamp>\d{2}-\w{3}-\d{4}\s+\d{2}:\d{2}:\d{2}\.\d{3})\s+queries:\s+info:\s+client\s+(?<client_ip>\d+\.\d+\.\d+\.\d+)#(?<client_port>\d+)\s+\((?<query_name>\S+)\):\s+query:\s+(?<query_name_full>\S+)\s+(?<query_class>\w+)\s+(?<query_type>\w+)
    Time_Key    timestamp
    Time_Format %d-%b-%Y %H:%M:%S.%L

# System log parsers
[PARSER]
    Name        syslog
    Format      regex
    Regex       ^(?<timestamp>\w+\s+\d+\s+\d+:\d+:\d+)\s+(?<hostname>\S+)\s+(?<service>\S+):\s+(?<message>.*)
    Time_Key    timestamp
    Time_Format %b %d %H:%M:%S

[PARSER]
    Name        auth_log
    Format      regex
    Regex       ^(?<timestamp>\w+\s+\d+\s+\d+:\d+:\d+)\s+(?<hostname>\S+)\s+(?<service>\S+)(?:\[(?<pid>\d+)\])?\s*:\s+(?<message>.*)
    Time_Key    timestamp
    Time_Format %b %d %H:%M:%S

# JSON parser for structured logs
[PARSER]
    Name        json
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On

# Docker log parser
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On